<!doctype html>
<html lang = "en" >
<head>
<meta charset = "utf-8" >
<meta name = "viewport" content= "width=device-width, initial-scale=1">
<meta name = "description" content = "View info regarding gbXML files" >
<meta name = "keywords" content = "gbXML,JavaScript,Markdown,GitHub,FOSS,3D,STEM" >
<meta name = "date" content = "2017-11-07" >
<title>Spider Table of Contents</title>

<style>
/* Copyright 2017 Ladybug Tools authors. MIT License */

/* https://www.w3schools.com/colors/colors_names.asp // use colors and borders to help identify the scope of particular elements */

	html { --mnu-color: MediumSlateBlue; --mnu-back-color: ivory; --mnu-width: 250px; height: 100%; }

	body, html { font: 12pt monospace; height: 100%; margin: 0; }

	a { color: crimson; text-decoration: none; }

	blockquote, pre { background-color: #eee; padding: 10px; }
	button, input[ type=button ] { background-color: #ddd; border: none; color: var( --mnu-color ); cursor: pointer; padding: 3px 20px; }
	button:hover { background-color: #ccc; color: #fff }

	.sidenav { background-color: ivory; box-sizing: border-box; height: 100%; left: 0; overflow: hidden; 
		position: fixed; top: 0; width: var( --mnu-width ); z-index: 1; transition: 0.5s; }

	.sidenav a:hover, .sidenav  a:focus{ color: #f1f1f1; }


	#hamburger { background-color: #edd;  box-sizing: border-box; cursor: pointer; font-size:30px; left: 250px; line-height: 30px; margin: 0; padding: 5px 15px 8px 10px;
		position: absolute; top: 20px; transition: left .5s; z-index: 1; }

	#divContainer { height: 100%; margin-left: 300px; transition: margin-left .5s; padding: 16px; position: relative; }
	#divContents { height: 100%; left: 0; position: absolute; margin: 0 auto; max-width: 800px; right: 0;}

	#divMenu { background-color: ivory; box-sizing: border-box; margin: 10px; }

	@media screen and ( max-height: 450px) { .sidenav {padding-top: 15px;} .sidenav a {font-size: 18px;} }

</style>
</head>
<body>
<script src = "https://cdn.rawgit.com/showdownjs/showdown/master/dist/showdown.min.js" ></script>


	<div id="divMenu" class="sidenav" >

		<p ><a href="http://www.ladybug.tools/" target="_blank">Ladybug Tools</a> &raquo; <a href="http://www.ladybug.tools/spider/" target="_Top" >&#x1f578;</a> &raquo; </p>

		<div id = "divTitle" title='' ></div>

		<div id="divBreadcrumbs"></div>

		<div id = "divMenuItems" ></div>

	</div>


	<div id = "divContainer" >

		<div id=divContents ></div>

	</div>


	<div id="hamburger" onclick=toggleNav(); >

		&#9776; slide

	</div>

<script>

	const urlGitHub = 'https://rawgit.com/ladybug-tools/spider/master/';
	const urlGitHubSource = 'https://github.com/ladybug-tools/spider/blob/master/';

	const urlGitHubApi = 'https://api.github.com/repos/ladybug-tools/spider/contents/';

	const infoURI = 'https://github.com/ladybug-tools/spider';
	const infoIcon = '<img src="https://status.github.com/images/invertocat.png" height=18 > </a>';


	init();

	function init() {

		divTitle.innerHTML =
			'<h3>' +
				'<a  href = "" >' + document.title + '</a> &nbsp; ' +
				'<a href=' + infoURI + ' target="_top" >' + infoIcon + '</a>' +
			'</h3>' +
		'';

		window.addEventListener ( 'hashchange', onHashChange, false );

		getFolderContents();

		onHashChange();

	}



	function onHashChange() {

		const url = !location.hash ? '../README.md' : location.hash.slice( 1 );

		if ( url.endsWith( 'md' ) ) {

			requestFile( urlGitHub + url, callbackMarkdown );

		} else {

			divContents.innerHTML = '<iframe src=' + urlGitHub + url + ' height=100% width=100% ></iframe>';

		}

	}



	function getFolderContents( path = '' ) {

		const url = urlGitHubApi + path;

		setBreadcrumbs( path );

		requestFile( url, callback );

		function callback( xhr ) {

			const response = xhr.target.response;
			const items = JSON.parse( response );

			divMenuItems.innerHTML = '';

			for ( let item of items ) {

				if ( item.type === 'dir' ) {

					divMenuItems.innerHTML +=
						'<div><a href=JavaScript:getFolderContents("' + item.path  + '");  > ðŸ—€ ' + item.name  + '</a></div>' +
					'';

				}

			}

			for ( let item of items ) {

				if ( item.type === 'file' ) {

					divMenuItems.innerHTML +=
					'<div>' +
						'<a href=#' + encodeURI( item.path ) + '  > ' + item.name + '</a> ' +
						'<a href="' + encodeURI( urlGitHubSource + item.path ) + '" target=_blank >' + infoIcon + '</a>' +
					'</div>';

				}

			}

		}

	}


	function setBreadcrumbs( path ) {

		let name, txt, folders, str;

//		name = user.repo;

//		name = user.path ? user.path : user.repo;

		txt = ''; //<h3><a href=JavaScript:getFolderContents(); >' + urlGitHub + '</a> &raquo; </h3>';

		folders = path ? path.split( '/' ) : [] ;

		str = '';

		for ( let folder of folders ) {

			str += folder + '/';

			txt += '<b><a href=JavaScript:getFolderContents("' + str.slice( 0, -1 ) + '"); >' + folder + '</a> &raquo; </b>';

		}

		divBreadcrumbs.innerHTML = txt;

	}


	function callbackMarkdown( xhr ){

		const converter = new showdown.Converter();
		const response = xhr.target.response;
		const html = converter.makeHtml( xhr.target.responseText );

		divContents.innerHTML = html;
		window.scrollTo( 0, 0 );

	}


	function requestFile( url, callback ) {

		const xhr = new XMLHttpRequest();
		xhr.crossOrigin = 'anonymous';
		xhr.open( 'GET', url, true );
		xhr.onerror = function( xhr ) { console.log( 'error:', xhr  ); };
//		xhr.onprogress = function( xhr ) { console.log(  'bytes loaded: ' + xhr.loaded.toLocaleString() ) }; /// or something
		xhr.onload = callback;
		xhr.send( null );

	}



	function toggleNav() {

		if ( !divMenu.style.width || divMenu.style.width === '250px' ) {

			divMenu.style.width = '0';
			hamburger.style.left = '0';
			divContainer.style.marginLeft = '0';

		} else {

			divMenu.style.width = '250px';
			hamburger.style.left = '250px';
			divContainer.style.marginLeft = '250px';

		}

	}

</script>
</body>
</html>